import{L as B}from"./Layout-BdsSE8cV.js";import{_ as g}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{ay as i,G as _,y as o,H as e,x as p,J as x,z as t,M as v,r as b,q as C,Y as L,P as d,O as w,ab as h}from"./vendor_vue-CyXBEfF2.js";import{g as E,a as N}from"./statistics-XXXciAyO.js";import"./vendor_misc-Dn7xwPo7.js";import"./index-C-RrEStG.js";import"./vendor_element-DkqkCxjX.js";const O={key:0,class:"cover"},V=["src"],$={class:"info"},D={__name:"BookCard",props:{book:Object},setup(n){return(a,m)=>{const c=i("el-card");return o(),_(c,{shadow:"hover"},{default:e(()=>[n.book.cover?(o(),p("div",O,[t("img",{src:n.book.cover,alt:"封面"},null,8,V)])):x("",!0),t("div",$,[t("h4",null,v(n.book.title),1),t("p",null,v(n.book.author),1)])]),_:1})}}},M=g(D,[["__scopeId","data-v-b8b4629b"]]),P={class:"kpi-title"},j={class:"kpi-value"},R={__name:"Dashboard",setup(n){const a=b([{title:"总图书",value:0},{title:"总读者",value:0},{title:"在借",value:0},{title:"今日借书",value:0}]),m=b([]);async function c(){try{const s=await E();if(s&&s.code===0){const l=s.data;a.value[0].value=l.totalBooks,a.value[1].value=l.totalReaders,a.value[2].value=l.borrowedCount,a.value[3].value=l.todayBorrows}const r=await N(8);r&&r.code===0&&(m.value=r.data)}catch(s){console.error(s)}}return C(()=>{c(),window.addEventListener("borrow-success",c)}),L(()=>{window.removeEventListener("borrow-success",c)}),(s,r)=>{const l=i("el-card"),f=i("el-col"),k=i("el-row");return o(),_(B,null,{default:e(()=>[d(k,{gutter:16},{default:e(()=>[(o(!0),p(w,null,h(a.value,(u,y)=>(o(),_(f,{span:6,key:y},{default:e(()=>[d(l,null,{default:e(()=>[t("div",P,v(u.title),1),t("div",j,v(u.value),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),r[0]||(r[0]=t("h4",{style:{"margin-top":"16px"}},"热门图书",-1)),d(k,{gutter:12},{default:e(()=>[(o(!0),p(w,null,h(m.value,u=>(o(),_(f,{span:4,key:u.id},{default:e(()=>[d(M,{book:u},null,8,["book"])]),_:2},1024))),128))]),_:1})]),_:1})}}};export{R as default};
