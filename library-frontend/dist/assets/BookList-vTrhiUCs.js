import{L as h}from"./Layout-BdsSE8cV.js";import{_ as D}from"./DataTable-MJnSbYJK.js";import{S as N}from"./SearchForm-aUpadHZH.js";import{f as $,d as z}from"./book-vvh8K-TE.js";import{r as n,q as P,Y as E,G as U,H as l,ay as u,y as j,z as v,P as e,L as p}from"./vendor_vue-CyXBEfF2.js";import"./vendor_misc-Dn7xwPo7.js";import"./index-C-RrEStG.js";import"./vendor_element-DkqkCxjX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"12px"}},Q={__name:"BookList",setup(F){const m=n({search:""}),_=n([]),b=n(0),c=n(1),y=n(20),f=n(!1),d=n(null);async function s(){const o=await $({page:c.value,size:y.value,search:m.value.search});o&&o.code===0&&(_.value=o.data.items,b.value=o.data.total)}P(()=>{s(),window.addEventListener("borrow-success",s)});function C(){c.value=1,s()}function k(o){c.value=o,s()}function g(){}function G(o){}function w(o){d.value=o,f.value=!0}async function x(){if(!d.value)return;const o=await z(d.value.id);o&&o.code===0&&(f.value=!1,s())}return E(()=>{window.removeEventListener("borrow-success",s)}),(o,t)=>{const B=u("el-input"),L=u("el-form-item"),r=u("el-button"),a=u("el-table-column"),S=u("el-dialog");return j(),U(h,null,{default:l(()=>[v("div",q,[e(N,{onSearch:C},{fields:l(()=>[e(L,null,{default:l(()=>[e(B,{modelValue:m.value.search,"onUpdate:modelValue":t[0]||(t[0]=i=>m.value.search=i),placeholder:"书名/作者/ISBN"},null,8,["modelValue"])]),_:1})]),_:1}),v("div",null,[e(r,{type:"primary",onClick:g},{default:l(()=>[...t[2]||(t[2]=[p("新增图书",-1)])]),_:1})])]),e(D,{data:_.value,total:b.value,onPageChange:k},{columns:l(()=>[e(a,{prop:"title",label:"书名"}),e(a,{prop:"author",label:"作者"}),e(a,{prop:"publisher",label:"出版社"}),e(a,{prop:"publishDate",label:"出版日期"}),e(a,{prop:"category",label:"分类"}),e(a,{prop:"availableCopies",label:"在馆数"}),e(a,{label:"操作"},{default:l(({row:i})=>[e(r,{type:"text",onClick:V=>void 0},{default:l(()=>[...t[3]||(t[3]=[p("编辑",-1)])]),_:1},8,["onClick"]),e(r,{type:"text",onClick:V=>w(i)},{default:l(()=>[...t[4]||(t[4]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","total"]),e(S,{title:"确认删除",visible:f.value},{footer:l(()=>[e(r,{onClick:t[1]||(t[1]=i=>f.value=!1)},{default:l(()=>[...t[5]||(t[5]=[p("取 消",-1)])]),_:1}),e(r,{type:"primary",onClick:x},{default:l(()=>[...t[6]||(t[6]=[p("确 定",-1)])]),_:1})]),default:l(()=>[t[7]||(t[7]=v("span",null,"确定要删除这本书吗？",-1))]),_:1},8,["visible"])]),_:1})}}};export{Q as default};
