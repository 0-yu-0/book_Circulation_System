const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-CemuZ-A1.js","assets/vendor_vue-CyXBEfF2.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/vendor_misc-Dn7xwPo7.js","assets/vendor_element-DkqkCxjX.js","assets/vendor_element-CmD_gl3T.css","assets/Login-C98aaRQD.css","assets/Dashboard-CIq-YsWV.js","assets/Layout-BdsSE8cV.js","assets/Layout-BZC-MNKo.css","assets/statistics-XXXciAyO.js","assets/Dashboard-B1lUP0Kh.css","assets/BookList-vTrhiUCs.js","assets/DataTable-MJnSbYJK.js","assets/SearchForm-aUpadHZH.js","assets/book-vvh8K-TE.js","assets/BookDetail-DMJwS6Nm.js","assets/ReaderList-B6fPLq42.js","assets/reader-ByGKMhQ5.js","assets/BorrowPage-BOhjcSzJ.js","assets/borrow-CqHv5Yvu.js","assets/ReturnPage-9QnHpf8t.js","assets/Statistics-bW4PaSSK.js"])))=>i.map(i=>d[i]);
import{G as A,u as L,aW as y,y as P,r as f,aX as I,aY as R,aQ as S}from"./vendor_vue-CyXBEfF2.js";import{P as O,Q as b,R as k}from"./vendor_misc-Dn7xwPo7.js";import{E as q,i as w}from"./vendor_element-DkqkCxjX.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const D={__name:"App",setup(e){return(t,n)=>(P(),A(L(y)))}},T="modulepreload",V=function(e){return"/"+e},_={},c=function(t,n,l){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(i=>{if(i=V(i),i in _)return;_[i]=!0;const m=i.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${g}`))return;const u=document.createElement("link");if(u.rel=m?"stylesheet":T,m||(u.as="script"),u.crossOrigin="",u.href=i,a&&u.setAttribute("nonce",a),document.head.appendChild(u),m)return new Promise((v,E)=>{u.addEventListener("load",v),u.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${i}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})},p=O.create({baseURL:"/api",timeout:1e4});p.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e});p.interceptors.response.use(e=>e.data,e=>{var t,n;return q.error(((n=(t=e.response)==null?void 0:t.data)==null?void 0:n.message)||e.message||"网络错误"),Promise.reject(e)});function B(e){return p.post("/auth/login",e)}function $(){return p.post("/auth/logout")}const U=b("auth",()=>{const e=f(null),t=f(localStorage.getItem("token")||""),n=f(!!t.value);async function l(o){const a=await B(o);return a&&a.code===0&&(t.value=a.data.token,e.value=a.data.user,n.value=!0,localStorage.setItem("token",t.value)),a}function r(){return t.value="",e.value=null,n.value=!1,localStorage.removeItem("token"),$()}function s(){const o=localStorage.getItem("token");t.value=o||"",n.value=!!o}return{user:e,token:t,isLoggedIn:n,login:l,logout:r,loadFromStorage:s}}),C=[{path:"/login",name:"Login",component:()=>c(()=>import("./Login-CemuZ-A1.js"),__vite__mapDeps([0,1,2,3,4,5,6]))},{path:"/",name:"Dashboard",component:()=>c(()=>import("./Dashboard-CIq-YsWV.js"),__vite__mapDeps([7,8,3,1,2,9,10,4,5,11])),meta:{requiresAuth:!0}},{path:"/books",name:"BookList",component:()=>c(()=>import("./BookList-vTrhiUCs.js"),__vite__mapDeps([12,8,3,1,2,9,13,14,15,4,5])),meta:{requiresAuth:!0}},{path:"/books/:id",name:"BookDetail",component:()=>c(()=>import("./BookDetail-DMJwS6Nm.js"),__vite__mapDeps([16,1])),meta:{requiresAuth:!0}},{path:"/readers",name:"ReaderList",component:()=>c(()=>import("./ReaderList-B6fPLq42.js"),__vite__mapDeps([17,8,3,1,2,9,13,14,18,4,5])),meta:{requiresAuth:!0}},{path:"/borrow",name:"Borrow",component:()=>c(()=>import("./BorrowPage-BOhjcSzJ.js"),__vite__mapDeps([19,8,3,1,2,9,14,13,18,15,20,4,5])),meta:{requiresAuth:!0}},{path:"/return",name:"Return",component:()=>c(()=>import("./ReturnPage-9QnHpf8t.js"),__vite__mapDeps([21,8,3,1,2,9,13,20,4,5])),meta:{requiresAuth:!0}},{path:"/statistics",name:"Statistics",component:()=>c(()=>import("./Statistics-bW4PaSSK.js"),__vite__mapDeps([22,8,3,1,2,9,13,10,4,5])),meta:{requiresAuth:!0}}],h=I({history:R(),routes:C});h.beforeEach((e,t,n)=>{const l=U();e.meta.requiresAuth&&!l.isLoggedIn?n({path:"/login"}):n()});const d=S(D);d.use(k());d.use(h);d.use(w);d.mount("#app");export{p as i,U as u};
