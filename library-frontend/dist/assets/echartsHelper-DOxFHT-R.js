import{V as p}from"./vendor_misc-BnRtHUQB.js";function z(n,{interval:r=100,timeout:i=1e4}={}){return new Promise((o,s)=>{if(!n)return s(new Error("Container is null"));const c=Date.now();function h(){const t=n.clientWidth,e=n.clientHeight;return t>0&&e>0?{width:t,height:e}:null}const a=h();if(a)return o(a);if(typeof IntersectionObserver<"u"){let t=null;const e=u=>{for(const l of u){const w=l.boundingClientRect||{},m=Math.floor(w.width||n.clientWidth),y=Math.floor(w.height||n.clientHeight);if(m>0&&y>0){try{t.disconnect()}catch{}return o({width:m,height:y})}}if(Date.now()-c>=i){try{t.disconnect()}catch{}return s(new Error("Container not ready (timeout)"))}};t=new IntersectionObserver(e,{root:null,threshold:[0,.01,.1]}),t.observe(n),setTimeout(()=>{const u=h();if(u)return o(u);try{t.disconnect()}catch{}return s(new Error("Container not ready (timeout)"))},i);return}let f=0;function d(){const t=h();if(t)return o(t);if(Date.now()-c>=i)return s(new Error("Container not ready (timeout)"));f++;const e=Math.min(i-(Date.now()-c),r*Math.pow(1.5,Math.min(f,6)));setTimeout(d,Math.max(50,Math.floor(e)))}d()})}function C(n,r,i=7,o=12){if(r<=0)return 12;const s=(n-o*2)/r,c=Math.max(4,Math.floor(s/i));return Math.min(c,40)}async function b(n,r,i={}){const{waitOptions:o={},avgCharPx:s=7,resize:c=!0}=i,h=await z(n,o),a=p(n),f=i.labelsCount||0,d=C(h.width,f||1,s),t=typeof r=="function"?r({chart:a,charLimit:d,size:h}):r;a.setOption(t);const e={};c&&(e.resize=()=>a.resize(),window.addEventListener("resize",e.resize));function u(){e.resize&&window.removeEventListener("resize",e.resize);try{a.dispose()}catch{}}return{chart:a,dispose:u}}export{b as i};
