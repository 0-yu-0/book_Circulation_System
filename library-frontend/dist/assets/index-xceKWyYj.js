const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-4w538rsw.js","assets/vendor_vue-DcrwGJHO.js","assets/vendor_element-BfRFdgV9.js","assets/vendor_misc-BnRtHUQB.js","assets/vendor_element-CmD_gl3T.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/Login-C3_gS3Mm.css","assets/Dashboard-CZE9c9ae.js","assets/Layout-BGNV5PTI.js","assets/Layout-9QBJJy0D.css","assets/statistics-AZdWBwl5.js","assets/echartsHelper-DOxFHT-R.js","assets/Dashboard-Buqgqz8s.css","assets/BookList-CgqkQm1T.js","assets/DataTable-BPSVB8sg.js","assets/DataTable-qQiwrcTm.css","assets/SearchForm-BReYfrNJ.js","assets/book-CtD6eXrW.js","assets/csv-D30QsHdy.js","assets/BookList-CSQGLk-t.css","assets/BookDetail-CvHiCTWq.js","assets/BookDetail-B0ToYby4.css","assets/ReaderList-B_TdXkZB.js","assets/reader-DiP4nMq6.js","assets/ReaderList-BmhXUytl.css","assets/ReaderDetail-D8YXVrpk.js","assets/ReaderDetail-CXLbs47f.css","assets/BorrowPage-Bhzx6L8r.js","assets/borrow-ByKR0lJe.js","assets/BorrowPage-Bic1ttr6.css","assets/ReturnPage-BNhsz6ix.js","assets/ReturnPage-Cy7E5f2s.css","assets/BorrowHistory-RYkjZZp2.js","assets/OverdueRecords-BLjsui7a.js","assets/Statistics-9rwxjWz8.js","assets/Statistics-CW9Suwy1.css","assets/Settings-BT2ap6pL.js","assets/Settings-JnGwMJuk.css"])))=>i.map(i=>d[i]);
import{G as L,u as P,aW as y,y as R,r as _,aX as O,aY as I,aQ as S}from"./vendor_vue-DcrwGJHO.js";import{P as b,Q as q,R as w}from"./vendor_misc-BnRtHUQB.js";import{E as D,i as k}from"./vendor_element-BfRFdgV9.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))u(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function u(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();const T={__name:"App",setup(t){return(n,e)=>(R(),L(P(y)))}},V="modulepreload",B=function(t){return"/"+t},h={},i=function(n,e,u){let r=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(e.map(c=>{if(c=B(c),c in h)return;h[c]=!0;const m=c.endsWith(".css"),E=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${E}`))return;const l=document.createElement("link");if(l.rel=m?"stylesheet":V,m||(l.as="script"),l.crossOrigin="",l.href=c,a&&l.setAttribute("nonce",a),document.head.appendChild(l),m)return new Promise((v,A)=>{l.addEventListener("load",v),l.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return n().catch(s)})},p=b.create({baseURL:"/api",timeout:1e4});p.interceptors.request.use(t=>{const n=localStorage.getItem("token");if(n&&(t.headers.Authorization=`Bearer ${n}`),t.params){const e=t.params;if(e.page!==void 0&&e.size!==void 0){const u=Number(e.page)||1,r=Number(e.size)||20;e.offset=Math.max(0,u-1)*r,e.limit=r,delete e.page,delete e.size}}return t});p.interceptors.response.use(t=>t.data,t=>{var n,e;return D.error(((e=(n=t.response)==null?void 0:n.data)==null?void 0:e.message)||t.message||"网络错误"),Promise.reject(t)});function $(t){return p.post("/auth/login",t)}function z(){return p.post("/auth/logout")}const g=q("auth",()=>{const t=_(null),n=_(localStorage.getItem("token")||""),e=_(!1);async function u(o){const a=await $(o);return a&&a.code===0&&(n.value=a.data.token,t.value=a.data.user,e.value=!0,localStorage.setItem("token",n.value)),a}function r(){return n.value="",t.value=null,e.value=!1,localStorage.removeItem("token"),z()}function s(){const o=localStorage.getItem("token");o&&(n.value=o,e.value=!1)}return{user:t,token:n,isLoggedIn:e,login:u,logout:r,loadFromStorage:s}}),N=[{path:"/",redirect:"/login"},{path:"/login",name:"Login",component:()=>i(()=>import("./Login-4w538rsw.js"),__vite__mapDeps([0,1,2,3,4,5,6]))},{path:"/dashboard",name:"Overview",component:()=>i(()=>import("./Dashboard-CZE9c9ae.js"),__vite__mapDeps([7,8,1,2,3,4,5,9,10,11,12])),meta:{requiresAuth:!0}},{path:"/books",name:"BookList",component:()=>i(()=>import("./BookList-CgqkQm1T.js"),__vite__mapDeps([13,8,1,2,3,4,5,9,14,15,16,17,18,19])),meta:{requiresAuth:!0}},{path:"/books/:id",name:"BookDetail",component:()=>i(()=>import("./BookDetail-CvHiCTWq.js"),__vite__mapDeps([20,8,1,2,3,4,5,9,17,21])),meta:{requiresAuth:!0}},{path:"/readers",name:"ReaderList",component:()=>i(()=>import("./ReaderList-B_TdXkZB.js"),__vite__mapDeps([22,8,1,2,3,4,5,9,14,15,16,23,18,24])),meta:{requiresAuth:!0}},{path:"/readers/:id",name:"ReaderDetail",component:()=>i(()=>import("./ReaderDetail-D8YXVrpk.js"),__vite__mapDeps([25,8,1,2,3,4,5,9,23,26])),meta:{requiresAuth:!0}},{path:"/borrow",name:"Borrow",component:()=>i(()=>import("./BorrowPage-Bhzx6L8r.js"),__vite__mapDeps([27,8,1,2,3,4,5,9,16,14,15,23,17,28,29])),meta:{requiresAuth:!0}},{path:"/return",name:"Return",component:()=>i(()=>import("./ReturnPage-BNhsz6ix.js"),__vite__mapDeps([30,1,8,2,3,4,5,9,14,15,28,23,10,31])),meta:{requiresAuth:!0}},{path:"/borrow-history",name:"BorrowHistory",component:()=>i(()=>import("./BorrowHistory-RYkjZZp2.js"),__vite__mapDeps([32,1,8,2,3,4,5,9,14,15,28])),meta:{requiresAuth:!0}},{path:"/overdue-records",name:"OverdueRecords",component:()=>i(()=>import("./OverdueRecords-BLjsui7a.js"),__vite__mapDeps([33,1,8,2,3,4,5,9,14,15,10])),meta:{requiresAuth:!0}},{path:"/statistics",name:"Statistics",component:()=>i(()=>import("./Statistics-9rwxjWz8.js"),__vite__mapDeps([34,8,1,2,3,4,5,9,14,15,10,11,35])),meta:{requiresAuth:!0}},{path:"/settings",name:"Settings",component:()=>i(()=>import("./Settings-BT2ap6pL.js"),__vite__mapDeps([36,8,1,2,3,4,5,9,37])),meta:{requiresAuth:!0}}],f=O({history:I(),routes:N});f.beforeEach((t,n,e)=>{const u=g();if(t.path==="/login"){e();return}t.meta.requiresAuth&&!u.isLoggedIn?e({path:"/login",query:{redirect:t.fullPath}}):e()});const d=S(T),U=w();d.use(U);d.use(f);d.use(k);f.isReady().then(()=>{g().loadFromStorage(),d.mount("#app")});export{p as i,g as u};
