import{r as n,q as C,G as D,H as o,ay as r,y as x,P as e,z as B,X as I,L as T}from"./vendor_vue-DcrwGJHO.js";import{L as S}from"./Layout-BGNV5PTI.js";import{D as M}from"./DataTable-BPSVB8sg.js";import{f as N}from"./borrow-ByKR0lJe.js";import{E as w}from"./vendor_element-BfRFdgV9.js";import"./index-xceKWyYj.js";import"./vendor_misc-BnRtHUQB.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={__name:"BorrowHistory",setup(L){const s=n({readerId:"",bookTitle:""}),b=n([]),_=n(!1),u=n(1),v=n(0),f=n(10);C(()=>{i()});async function i(){_.value=!0;try{const l={page:u.value,size:f.value,...s.value},a=await N(l);if(a&&a.code===0){const c=a.data||{},p=c.items||[],d={0:"在借",1:"已还",2:"逾期"};b.value=p.map(m=>({...m,status:d[m.borrowStates]||m.status||"未知"})),v.value=c.total||p.length||0}else w.error((a==null?void 0:a.message)||"获取借阅记录失败")}catch(l){w.error("获取借阅记录失败: "+(l.message||l))}finally{_.value=!1}}function y(){u.value=1,i()}function V(l){u.value=l,i()}function k(l){f.value=l,u.value=1,i()}return(l,a)=>{const c=r("el-page-header"),p=r("el-input"),d=r("el-form-item"),m=r("el-button"),z=r("el-form"),h=r("el-card"),t=r("el-table-column");return x(),D(S,null,{default:o(()=>[e(c,null,{content:o(()=>[...a[2]||(a[2]=[B("span",null,"借阅历史",-1)])]),_:1}),e(h,{style:{"margin-top":"20px"}},{default:o(()=>[e(z,{inline:!0,onSubmit:I(y,["prevent"])},{default:o(()=>[e(d,{label:"读者ID"},{default:o(()=>[e(p,{modelValue:s.value.readerId,"onUpdate:modelValue":a[0]||(a[0]=g=>s.value.readerId=g),placeholder:"请输入读者ID"},null,8,["modelValue"])]),_:1}),e(d,{label:"图书名称"},{default:o(()=>[e(p,{modelValue:s.value.bookTitle,"onUpdate:modelValue":a[1]||(a[1]=g=>s.value.bookTitle=g),placeholder:"请输入图书名称"},null,8,["modelValue"])]),_:1}),e(d,null,{default:o(()=>[e(m,{type:"primary",onClick:y},{default:o(()=>[...a[3]||(a[3]=[T("查询",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(h,{style:{"margin-top":"20px"}},{default:o(()=>[e(M,{data:b.value,loading:_.value,total:v.value,page:u.value,"page-size":f.value,onPageChange:V,onSizeChange:k},{columns:o(()=>[e(t,{prop:"borrowId",label:"借阅编号"}),e(t,{prop:"readerName",label:"读者姓名"}),e(t,{prop:"bookTitle",label:"书名"}),e(t,{prop:"borrowDate",label:"借出日期"}),e(t,{prop:"dueDate",label:"应还日期"}),e(t,{prop:"returnDate",label:"归还日期"}),e(t,{prop:"status",label:"状态"})]),_:1},8,["data","loading","total","page","page-size"])]),_:1})]),_:1})}}};export{X as default};
